<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gerador MIT (Presumido) - Neo</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">

    <style>
      :root {
        /* Paleta Neo-Brutalismo */
        --bg-color: #FFFDF5;
        --card-bg: #FFFFFF;
        
        --primary-green: #2DDD98;
        --primary-yellow: #FFF59D;
        --primary-purple: #D6BCFA;
        --primary-pink: #FF9EB5;
        --primary-blue: #A5DEFF;
        
        --text-main: #000000;
        --border-black: #000000;
        
        --shadow-hard: 4px 4px 0px 0px #000000;
        --border-width: 3px;
        --radius: 12px;
      }

      * { margin: 0; padding: 0; box-sizing: border-box; }

      body {
        font-family: 'Inter', sans-serif;
        background-color: var(--bg-color);
        color: var(--text-main);
        height: 100vh;
        overflow-x: hidden;
        display: flex;
      }

      /* Sidebar */
      .sidebar {
        width: 250px;
        background: var(--card-bg);
        border-right: var(--border-width) solid var(--border-black);
        display: flex;
        flex-direction: column;
        padding: 2rem 1.5rem;
        flex-shrink: 0;
      }

      .logo {
        font-weight: 800;
        font-size: 1.4rem;
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 3rem;
        text-decoration: none;
        color: black;
      }

      .logo i {
        background: var(--primary-green);
        padding: 8px;
        border: var(--border-width) solid var(--border-black);
        border-radius: 50%;
        box-shadow: 2px 2px 0 0 black;
      }

      .nav-item {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 1rem;
        margin-bottom: 1rem;
        font-weight: 600;
        color: #555;
        cursor: pointer;
        transition: 0.2s;
        border-radius: var(--radius);
        border: 2px solid transparent;
        text-decoration: none;
      }

      .nav-item.active {
        background-color: var(--primary-purple);
        color: black;
        border: var(--border-width) solid var(--border-black);
        box-shadow: var(--shadow-hard);
      }
      .nav-item:hover:not(.active) { background-color: #f0f0f0; }

      .main-content { flex: 1; padding: 2rem; overflow-y: auto; }

      /* Neo Header */
      .neo-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 2rem;
        background: var(--card-bg);
        border: var(--border-width) solid var(--border-black);
        border-radius: 50px;
        padding: 1rem 2rem;
        box-shadow: var(--shadow-hard);
      }
      .header-title h1 { font-weight: 800; font-size: 2rem; }
      .header-title span { font-size: 1rem; font-weight: 600; color: #666; }

      /* Cards */
      .neo-card {
        background: var(--card-bg);
        border: var(--border-width) solid var(--border-black);
        border-radius: var(--radius);
        padding: 2rem;
        box-shadow: var(--shadow-hard);
        margin-bottom: 2rem;
        position: relative;
      }

      .card-title {
        font-weight: 900;
        font-size: 1.2rem;
        margin-bottom: 1.5rem;
        display: flex;
        align-items: center;
        gap: 10px;
        text-transform: uppercase;
        border-bottom: 2px solid #eee;
        padding-bottom: 10px;
      }
      
      /* Cores de borda superior para diferenciar se√ß√µes */
      .border-top-purple { border-top: 6px solid var(--primary-purple); }
      .border-top-green { border-top: 6px solid var(--primary-green); }
      .border-top-pink { border-top: 6px solid var(--primary-pink); }
      .border-top-blue { border-top: 6px solid var(--primary-blue); }

      /* Formul√°rios */
      .form-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1.5rem;
      }

      .form-group { margin-bottom: 1rem; }
      
      label {
        font-weight: 700;
        display: block;
        margin-bottom: 0.5rem;
        font-size: 0.9rem;
      }

      .neo-input {
        width: 100%;
        padding: 0.8rem;
        font-size: 1rem;
        font-weight: 500;
        border: var(--border-width) solid var(--border-black);
        border-radius: var(--radius);
        outline: none;
        background: #f9f9f9;
        transition: 0.1s;
      }
      .neo-input:focus {
        background-color: #fff;
        box-shadow: 4px 4px 0 0 rgba(0,0,0,0.1);
        transform: translate(-2px, -2px);
      }

      small {
        display: block;
        margin-top: 5px;
        font-size: 0.8rem;
        color: #666;
        font-weight: 600;
      }

      /* Bot√µes */
      .neo-btn {
        padding: 1rem 2rem;
        font-weight: 800;
        font-size: 1rem;
        border: var(--border-width) solid var(--border-black);
        border-radius: var(--radius);
        cursor: pointer;
        box-shadow: var(--shadow-hard);
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
        transition: transform 0.1s;
        text-transform: uppercase;
      }
      .neo-btn:active {
        box-shadow: 0 0 0 0 black;
        transform: translate(4px, 4px);
      }

      .btn-save { background-color: var(--primary-green); color: black; width: 100%; margin-top: 1rem; }
      .btn-generate { background-color: var(--primary-purple); color: black; font-size: 1.2rem; width: 100%; }
      .btn-copy { background-color: var(--primary-blue); color: black; margin-top: 1rem; display: none; }

      /* Info Box */
      .info-box {
        background: #eefaff;
        border: var(--border-width) solid black;
        border-radius: var(--radius);
        padding: 1.5rem;
        margin-bottom: 2rem;
        box-shadow: var(--shadow-hard);
      }
      .info-box h2 { font-size: 1.1rem; font-weight: 800; margin-bottom: 1rem; }
      .info-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; }
      .info-item strong { display: block; font-size: 0.8rem; color: #555; }

      /* Resultado JSON */
      #resultado {
        margin-top: 2rem;
        padding: 1.5rem;
        background: #1a1a1a;
        color: #00ff00;
        border: var(--border-width) solid black;
        border-radius: var(--radius);
        font-family: 'Space Mono', monospace;
        white-space: pre-wrap;
        display: none;
        max-height: 400px;
        overflow-y: auto;
        box-shadow: var(--shadow-hard);
      }

      /* Modal */
      .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        backdrop-filter: blur(4px);
      }

      .modal-content {
        background-color: var(--primary-yellow);
        margin: 10% auto;
        padding: 2rem;
        border: var(--border-width) solid black;
        border-radius: var(--radius);
        width: 90%;
        max-width: 500px;
        box-shadow: 8px 8px 0 0 black;
        position: relative;
        text-align: center;
      }

      .close-modal {
        position: absolute;
        top: 10px;
        right: 15px;
        font-size: 28px;
        font-weight: bold;
        cursor: pointer;
        color: black;
      }
      
      .modal-btn {
        background: black;
        color: white;
        margin-top: 20px;
      }
      .modal-btn:hover { background: #333; }

      @media (max-width: 768px) {
        body { flex-direction: column; }
        .sidebar { width: 100%; border-right: none; border-bottom: 3px solid black; flex-direction: row; align-items: center; overflow-x: auto; padding: 1rem; }
        .neo-header { flex-direction: column; gap: 1rem; text-align: center; }
        .form-grid { grid-template-columns: 1fr; }
      }
    </style>
  </head>
  <body>

    <aside class="sidebar">
      <a href="index.html" class="logo">
        <i class="fas fa-file-code"></i>
        <span>MIT Generator</span>
      </a>
      <nav>
        <a href="#" class="nav-item active">
          <i class="fas fa-calculator"></i> Lucro Presumido
        </a>
        <a href="index.html" class="nav-item">
          <i class="fas fa-arrow-left"></i> Voltar
        </a>
      </nav>
    </aside>

    <main class="main-content">
      
      <div class="neo-header">
        <div class="header-title">
          <h1>Gerador JSON üìÑ</h1>
          <span>M√≥dulo de Integra√ß√£o Tribut√°ria (E-CAC)</span>
        </div>
      </div>

      <div id="infoArmazenada" class="info-box" style="display: none">
        <h2><i class="fas fa-user-check"></i> Respons√°vel Salvo</h2>
        <div class="info-grid">
            <div class="info-item"><strong>CPF</strong> <span id="cpfSalvo"></span></div>
            <div class="info-item"><strong>Telefone</strong> (<span id="dddSalvo"></span>) <span id="telefoneSalvo"></span></div>
            <div class="info-item"><strong>Email</strong> <span id="emailSalvo"></span></div>
            <div class="info-item"><strong>CRC</strong> <span id="crcSalvo"></span> (<span id="ufSalvo"></span>)</div>
        </div>
      </div>

      <form id="formJson">
        
        <div class="neo-card border-top-purple">
            <div class="card-title"><i class="fas fa-cog"></i> Configura√ß√£o Inicial</div>
            <div class="form-grid">
                <div class="form-group">
                    <label for="cnpjRaiz">CNPJ Raiz (8 d√≠gitos)</label>
                    <input type="text" id="cnpjRaiz" class="neo-input" maxlength="8" pattern="[0-9]{8}" required placeholder="Ex: 12345678" />
                </div>
                <div class="form-group">
                    <label for="mesApuracao">M√™s</label>
                    <input type="number" id="mesApuracao" class="neo-input" min="1" max="12" required placeholder="Ex: 1" />
                </div>
                <div class="form-group">
                    <label for="anoApuracao">Ano</label>
                    <input type="number" id="anoApuracao" class="neo-input" min="2000" max="2100" required placeholder="Ex: 2025" />
                </div>
            </div>
        </div>

        <div class="neo-card border-top-green">
            <div class="card-title"><i class="fas fa-user-tie"></i> Respons√°vel pela Apura√ß√£o</div>
            <div class="form-grid">
                <div class="form-group">
                    <label for="cpfResponsavel">CPF</label>
                    <input type="text" id="cpfResponsavel" class="neo-input" maxlength="11" placeholder="Somente n√∫meros" />
                </div>
                <div class="form-group">
                    <label>Telefone</label>
                    <div style="display: flex; gap: 10px;">
                        <input type="text" id="dddResponsavel" class="neo-input" style="width: 80px;" maxlength="2" placeholder="DDD" />
                        <input type="text" id="numTelefone" class="neo-input" maxlength="9" placeholder="N√∫mero" />
                    </div>
                </div>
                <div class="form-group">
                    <label for="emailResponsavel">Email</label>
                    <input type="email" id="emailResponsavel" class="neo-input" placeholder="email@exemplo.com" />
                </div>
                <div class="form-group">
                    <label for="estadoUF">UF CRC</label>
                    <select id="estadoUF" class="neo-input">
                        <option value="">UF</option>
                        <option value="AC">AC</option><option value="AL">AL</option><option value="AP">AP</option>
                        <option value="AM">AM</option><option value="BA">BA</option><option value="CE">CE</option>
                        <option value="DF">DF</option><option value="ES">ES</option><option value="GO">GO</option>
                        <option value="MA">MA</option><option value="MT">MT</option><option value="MS">MS</option>
                        <option value="MG">MG</option><option value="PA">PA</option><option value="PB">PB</option>
                        <option value="PR">PR</option><option value="PE">PE</option><option value="PI">PI</option>
                        <option value="RJ">RJ</option><option value="RN">RN</option><option value="RS">RS</option>
                        <option value="RO">RO</option><option value="RR">RR</option><option value="SC">SC</option>
                        <option value="SP">SP</option><option value="SE">SE</option><option value="TO">TO</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="numRegistroCRC">Registro CRC</label>
                    <input type="text" id="numRegistroCRC" class="neo-input" placeholder="Ex: MG000000" />
                </div>
            </div>
            <button type="button" id="salvarDados" class="neo-btn btn-save">
                <i class="fas fa-save"></i> Salvar Respons√°vel
            </button>
        </div>

        <div class="neo-card border-top-pink">
            <div class="card-title"><i class="fas fa-money-bill-wave"></i> Valores de D√©bitos</div>
            <div class="form-grid">
                <div class="form-group">
                    <label>PIS/PASEP (8109)</label>
                    <input type="number" id="valorDebitoPisPasep" class="neo-input" step="0.01" min="0" placeholder="0,00" />
                </div>
                <div class="form-group">
                    <label>COFINS (2172)</label>
                    <input type="number" id="valorDebitoCofins" class="neo-input" step="0.01" min="0" placeholder="0,00" />
                </div>
                <div class="form-group">
                    <label>IRPJ (2089) <small>Apenas Trimestral</small></label>
                    <input type="number" id="valorDebitoIrpj" class="neo-input" step="0.01" min="0" placeholder="0,00" />
                </div>
                <div class="form-group">
                    <label>CSLL (2372) <small>Apenas Trimestral</small></label>
                    <input type="number" id="valorDebitoCsll" class="neo-input" step="0.01" min="0" placeholder="0,00" />
                </div>
            </div>
        </div>

        <button type="button" id="gerarJson" class="neo-btn btn-generate">
            <i class="fas fa-code"></i> GERAR E BAIXAR JSON
        </button>

      </form>

      <div id="resultado"></div>
      <button type="button" id="copiarJson" class="neo-btn btn-copy">
          <i class="fas fa-copy"></i> COPIAR JSON
      </button>

    </main>

    <div id="alertModal" class="modal">
      <div class="modal-content">
        <span class="close-modal" id="fecharModal">&times;</span>
        <h2 style="font-weight:900; font-size: 1.5rem; margin-bottom: 1rem;"><i class="fas fa-exclamation-triangle"></i> ATEN√á√ÉO!</h2>
        <p style="font-weight:600; margin-bottom: 1rem;">
          √â fundamental a confer√™ncia dos dados ap√≥s a importa√ß√£o no E-CAC.
        </p>
        <p>
            O arquivo JSON foi gerado com sucesso e o download iniciar√° automaticamente.
        </p>
        <button id="confirmarModal" class="neo-btn modal-btn">ENTENDI</button>
      </div>
    </div>

    <script>
      const STORAGE_KEY = "mitResponsavelData";

      document.addEventListener("DOMContentLoaded", function () {
        carregarDadosSalvos();
      });

      function carregarDadosSalvos() {
        const dadosSalvos = localStorage.getItem(STORAGE_KEY);
        if (dadosSalvos) {
          const dados = JSON.parse(dadosSalvos);
          document.getElementById("cpfResponsavel").value = dados.cpf || "";
          document.getElementById("dddResponsavel").value = dados.ddd || "";
          document.getElementById("numTelefone").value = dados.telefone || "";
          document.getElementById("emailResponsavel").value = dados.email || "";
          document.getElementById("estadoUF").value = dados.uf || "";
          document.getElementById("numRegistroCRC").value = dados.registroCrc || "";

          document.getElementById("cpfSalvo").textContent = dados.cpf || "";
          document.getElementById("dddSalvo").textContent = dados.ddd || "";
          document.getElementById("telefoneSalvo").textContent = dados.telefone || "";
          document.getElementById("emailSalvo").textContent = dados.email || "";
          document.getElementById("crcSalvo").textContent = dados.registroCrc || "";
          document.getElementById("ufSalvo").textContent = dados.uf || "";

          document.getElementById("infoArmazenada").style.display = "block";
        }
      }

      document.getElementById("salvarDados").addEventListener("click", function () {
          const cpf = document.getElementById("cpfResponsavel").value;
          const ddd = document.getElementById("dddResponsavel").value;
          const telefone = document.getElementById("numTelefone").value;
          const email = document.getElementById("emailResponsavel").value;
          const uf = document.getElementById("estadoUF").value;
          const registroCrc = document.getElementById("numRegistroCRC").value;

          if (!cpf || !ddd || !telefone || !email || !uf || !registroCrc) {
            alert("Preencha todos os campos do respons√°vel antes de salvar.");
            return;
          }

          const dadosResponsavel = { cpf, ddd, telefone, email, uf, registroCrc };
          localStorage.setItem(STORAGE_KEY, JSON.stringify(dadosResponsavel));

          document.getElementById("cpfSalvo").textContent = cpf;
          document.getElementById("dddSalvo").textContent = ddd;
          document.getElementById("telefoneSalvo").textContent = telefone;
          document.getElementById("emailSalvo").textContent = email;
          document.getElementById("crcSalvo").textContent = registroCrc;
          document.getElementById("ufSalvo").textContent = uf;

          document.getElementById("infoArmazenada").style.display = "block";
          alert("Dados salvos com sucesso!");
        });

      document.getElementById("gerarJson").addEventListener("click", function () {
          const cnpjRaiz = document.getElementById("cnpjRaiz").value;
          const mesApuracao = parseInt(document.getElementById("mesApuracao").value);
          const anoApuracao = parseInt(document.getElementById("anoApuracao").value);
          
          const valorDebitoIrpj = parseFloat(document.getElementById("valorDebitoIrpj").value || 0);
          const valorDebitoCsll = parseFloat(document.getElementById("valorDebitoCsll").value || 0);
          const valorDebitoPisPasep = parseFloat(document.getElementById("valorDebitoPisPasep").value || 0);
          const valorDebitoCofins = parseFloat(document.getElementById("valorDebitoCofins").value || 0);

          const cpfResponsavel = document.getElementById("cpfResponsavel").value;
          const dddResponsavel = document.getElementById("dddResponsavel").value;
          const numTelefone = document.getElementById("numTelefone").value;
          const emailResponsavel = document.getElementById("emailResponsavel").value;
          const ufRegistro = document.getElementById("estadoUF").value;
          const numRegistro = document.getElementById("numRegistroCRC").value;

          if (cnpjRaiz.length !== 8) { alert("Informe os 8 d√≠gitos da raiz do CNPJ."); return; }
          if (!mesApuracao || !anoApuracao) { alert("Preencha m√™s e ano corretamente."); return; }
          if (!cpfResponsavel || !dddResponsavel || !numTelefone || !emailResponsavel || !ufRegistro || !numRegistro) {
            alert("Preencha todos os campos do respons√°vel."); return;
          }

          const jsonObj = {
            PeriodoApuracao: { MesApuracao: mesApuracao, AnoApuracao: anoApuracao },
            DadosIniciais: {
              SemMovimento: false, QualificacaoPj: 1, TributacaoLucro: 3, VariacoesMonetarias: 1,
              ResponsavelApuracao: {
                CpfResponsavel: cpfResponsavel,
                TelResponsavel: { Ddd: dddResponsavel, NumTelefone: numTelefone },
                EmailResponsavel: emailResponsavel,
                RegistroCrc: { UfRegistro: ufRegistro, NumRegistro: numRegistro },
              },
            },
            Debitos: {},
          };

          let idDebitoCounter = 1;

          if (valorDebitoIrpj > 0) jsonObj.Debitos.Irpj = { ListaDebitos: [{ IdDebito: idDebitoCounter++, CodigoDebito: "208901", ValorDebito: valorDebitoIrpj }] };
          if (valorDebitoCsll > 0) jsonObj.Debitos.Csll = { ListaDebitos: [{ IdDebito: idDebitoCounter++, CodigoDebito: "237201", ValorDebito: valorDebitoCsll }] };
          if (valorDebitoPisPasep > 0) jsonObj.Debitos.PisPasep = { ListaDebitos: [{ IdDebito: idDebitoCounter++, CodigoDebito: "810902", ValorDebito: valorDebitoPisPasep }] };
          if (valorDebitoCofins > 0) jsonObj.Debitos.Cofins = { ListaDebitos: [{ IdDebito: idDebitoCounter++, CodigoDebito: "217201", ValorDebito: valorDebitoCofins }] };

          const jsonString = JSON.stringify(jsonObj, null, 2);
          const resultadoDiv = document.getElementById("resultado");
          resultadoDiv.textContent = jsonString;
          resultadoDiv.style.display = "block";
          
          document.getElementById("copiarJson").style.display = "block";
          
          downloadJson(jsonObj, cnpjRaiz);
          document.getElementById("alertModal").style.display = "block";
      });

      function downloadJson(jsonData, cnpjRaiz) {
        const mesApuracao = document.getElementById("mesApuracao").value.padStart(2, "0");
        const anoApuracao = document.getElementById("anoApuracao").value;
        const nomeArquivo = `${cnpjRaiz}-MIT-${anoApuracao}${mesApuracao}.json`;
        const blob = new Blob([JSON.stringify(jsonData, null, 2)], { type: "application/json" });
        const url = URL.createObjectURL(blob);
        const link = document.createElement("a");
        link.href = url;
        link.download = nomeArquivo;
        document.body.appendChild(link);
        link.click();
        setTimeout(() => { document.body.removeChild(link); URL.revokeObjectURL(url); }, 100);
      }

      document.getElementById("copiarJson").addEventListener("click", function () {
          const resultadoDiv = document.getElementById("resultado");
          navigator.clipboard.writeText(resultadoDiv.textContent)
            .then(() => alert("JSON copiado!"))
            .catch((err) => alert("Erro ao copiar."));
      });

      document.getElementById("confirmarModal").addEventListener("click", function () {
          document.getElementById("alertModal").style.display = "none";
      });
      document.getElementById("fecharModal").addEventListener("click", function () {
          document.getElementById("alertModal").style.display = "none";
      });
      window.onclick = function (event) {
        let modal = document.getElementById("alertModal");
        if (event.target === modal) modal.style.display = "none";
      };
    </script>
  </body>
</html>